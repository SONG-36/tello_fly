# 系统架构与功能模块设计（System Architecture & Module Design）

---

## 1 需求-功能-模块溯源对照表（Traceability Matrix）

| 需求编号 | 需求描述                 | 功能点                  | 对应模块        | 实现文件/接口                           |
| -------- | ------------------------ | ----------------------- | --------------- | --------------------------------------- |
| BR-01    | 一键自动巡检/跟踪        | 自动启动、任务切换      | 主流程/控制模块 | main.py, control.py                     |
| BR-02    | 智能检测与目标跟踪       | 目标检测、跟踪控制      | AI识别/跟踪模块 | ai/detection.py, ai/tracker.py          |
| BR-03    | 上位机可视化交互界面     | 实时视频显示、任务管理  | 上位机GUI模块   | gui/main_window.py                      |
| BR-04    | 虚拟遥控器与任务配置     | 按钮控制、参数设置      | GUI/配置模块    | gui/remote_panel.py, config/params.py   |
| BR-05    | 视频流回传与数据存档     | 视频抓取、存储、回放    | 视频流/存储模块 | video/stream.py, storage/data.py        |
| BR-06    | 异常检测与智能提示       | 异常识别、弹窗/日志提示 | 状态/日志模块   | monitor/events.py, gui/notify.py        |
| BR-07    | 用户自定义巡检模板与计划 | 任务模板保存、定时任务  | 配置/调度模块   | config/templates.py, scheduler/timer.py |
| BR-08    | 开源扩展/模块化API       | 插件机制、API接口       | 插件/接口模块   | api/plugins.py, api/doc.md              |
| BR-09    | 简单部署与维护           | 一键安装、部署脚本      | 部署/环境模块   | setup/install.sh, requirements.txt      |

---

## 2 系统分层架设计

### 2.1 系统层次划分



## 3 核心功能模块详细设计

### 3.1 主流程/控制模块

| 项目      | 内容                                                 |
| --------- | ---------------------------------------------------- |
| 对应需求  | BR-01（自动巡检/跟踪）、BR-07（定时任务）            |
| 功能描述  | 负责系统主入口，任务流转、任务调度与切换             |
| 主要接口  | `start_mission()`, `switch_task()`, `stop_mission()` |
| 输入/输出 | 上位机指令、状态反馈                                 |
| 异常/流程 | 监控执行状态，异常处理与切换                         |

### 3.2 AI识别/跟踪模块

| 项目      | 内容                                      |
| --------- | ----------------------------------------- |
| 对应需求  | BR-02（智能检测/跟踪）、BR-06（异常检测） |
| 功能描述  | 集成YOLO/跟踪算法，目标检测与动态跟踪功能 |
| 主要接口  | `detect(frame)`, `track(target)`          |
| 输入/输出 | 视频帧流、检测结果、跟踪坐标              |
| 异常/流程 | 目标丢失、误检自恢复                      |

### 3.3 上位机GUI模块

| 项目          | 内容                                                         |
| ------------- | ------------------------------------------------------------ |
| 对应需求      | BR-03（可视化交互界面）、BR-04（虚拟遥控/参数）              |
| 功能描述      | 提供桌面端可视化操作入口，集成实时视频显示、参数管理、虚拟遥控与日志 |
| 主要接口/窗口 | `MainWindow`, `RemotePanel`, `ConfigDialog`, `LogViewer`     |
| 输入/输出     | 用户操作/无人机控制命令/状态信息                             |
| 异常/流程     | 支持参数编辑、任务切换、异常反馈                             |

### 3.4 配置/参数/调度模块

| 项目      | 内容                                                     |
| --------- | -------------------------------------------------------- |
| 对应需求  | BR-04（任务配置）、BR-07（模板/计划）、BR-09（部署维护） |
| 功能描述  | 参数配置文件解析、模板保存、定时任务调度                 |
| 主要接口  | `load_config()`, `save_template()`, `schedule_task()`    |
| 输入/输出 | 配置文件、运行参数、模板                                 |
| 异常/流程 | 配置异常检测、定时执行异常                               |

### 3.5 视频流/数据存储模块

| 项目      | 内容                                                    |
| --------- | ------------------------------------------------------- |
| 对应需求  | BR-05（视频/数据）、BR-08（扩展API）                    |
| 功能描述  | 采集无人机视频流，本地保存、历史回放、API扩展           |
| 主要接口  | `save_video()`, `playback(time_range)`, `export_data()` |
| 输入/输出 | 视频流、历史数据、API调用结果                           |
| 异常/流程 | 存储失败、读写异常                                      |

### 3.6 日志/异常处理模块

| 项目      | 内容                                             |
| --------- | ------------------------------------------------ |
| 对应需求  | BR-06（异常检测/提示）、BR-03（日志可视化）      |
| 功能描述  | 任务执行、状态变更、异常日志与弹窗提示           |
| 主要接口  | `log_event(type, message)`, `notify_user(event)` |
| 输入/输出 | 事件类型、提示消息                               |
| 异常/流程 | 日志丢失、弹窗异常处理                           |